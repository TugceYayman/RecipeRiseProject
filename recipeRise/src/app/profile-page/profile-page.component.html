<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profile</title>
</head>
<body>
<app-navbar></app-navbar>
<div class="container">
    <div class="row">
        <!-- Profile Sidebar -->
        <div class="col-md-4">
            <div class="profile-sidebar">
                <!-- User Image and Title -->
                <div class="d-flex align-items-center">
                    <div class="profile-userpic my-3">
                        <img width="170px" height="170px" src="/assets/images/bolognese.jpeg" class="img-fluid rounded-circle" alt="User Image" id="selectedProfilePic">
                    </div>
                      <div class="profile-usertitle ms-3">
                        <div class="profile-usertitle-name">
                            <h1>Hi, {{username}} </h1>
                        </div>
                    </div>
                </div>
                <!-- Button to trigger modal -->
                <!-- Button to trigger file selector -->
                <input type="file" accept="image/*" id="profilePictureInput" style="display: none;" (change)="onFileSelect($event)">
                <button type="button" class="changeButton" (click)="openFileSelector()">
                    Change Profile Picture
                </button>
                <nav class="profile-usermenu">
                  <ul class="nav flex-column">
                    <li class="nav-item">
                      <a class="nav-link" (click)="showSection('personal-info')">Personal Info</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" (click)="showSection('public-profile')">My Recipes</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" (click)="showSection('change-password')">Change Password</a>
                    </li>
                  </ul>
                </nav>
            </div>
        </div>
         <!-- Profile Content -->
          <div class="col-md-8">
            <div class="profile-content" id="content-section">
            <div *ngIf="activeSection === 'personal-info'">
              <h2>Personal Info</h2>
              <p>These details will be used for your profile. By filling out this information, you will receive a more personalized experience on our website.</p>
              <form id="personal-info-form">
                  <div class="form-group">
                      <label for="emailAddress">Email Address*</label>
                      <input type="email" class="form-control" id="emailAddress" placeholder="user@example.com" required>
                  </div>
                  <div class="form-row">
                      <div class="form-group col-md-6">
                          <label for="firstName">First Name</label>
                          <input type="text" class="form-control" id="firstName" placeholder="First Name">
                      </div>
                      <div class="form-group col-md-6">
                          <label for="lastName">Last Name</label>
                          <input type="text" class="form-control" id="lastName" placeholder="Last Name">
                      </div>
                  </div>
                  <div class="form-group">
                      <label for="birthDate">Birth Date</label>
                      <input type="date" class="form-control" id="birthDate">
                  </div>
               
                  <button type="submit" class="btn">Save Changes</button>
              </form>
            </div>
            <div *ngIf="activeSection === 'public-profile'">
              <h2>My Recipes</h2>
              <!-- Recipes Section -->
              <div *ngIf="recipes.length > 0; else noRecipesTemplate">
                
              <!-- Within your component's template, e.g., profile-page.component.html -->
              <div *ngFor="let recipe of recipes" class="card my-3" style="background-color: #dcecec">
                <div class="row g-0">
                  <div class="col-md-4">
                    <!-- Bind the src attribute to your image path, which might need to be adjusted based on your backend configuration -->
                    <img [src]="getFullImageUrl(recipe.image)" alt="Recipe image" class="img-fluid rounded-start" style="height: 250px; object-fit: cover;">
                  </div>
                  <div class="col-md-8">
                    <div class="card-body">
                      <h5 class="card-title">{{ recipe.title }}</h5>
                      <!-- Use the truncateInstructions method to limit the instructions' length -->
                      <p class="card-text">{{ truncateInstructions(recipe.instructions) }}</p>
                      <!-- Display the cuisine_id until you have a way to get the cuisine name -->
                      <p class="card-text">Cuisine: {{ recipe.cuisine_name }}</p>
                      <!-- Link to view the recipe details -->
                      <a [routerLink]="['/recipes', recipe.id]" class="btn btn-outline-secondary">
                        View Recipe
                      </a>                      
                    </div>
                  </div>
                </div>
              </div>

              </div>

                <ng-template #noRecipesTemplate>
                  <p>You have not added any recipes yet.</p>
                </ng-template>
             
            </div>

            <div *ngIf="activeSection === 'change-password'">
              <h2>Change Password</h2>
              <p>Secure your account by updating your password regularly.</p>
              <form id="change-password-form " (ngSubmit)="changePassword(currentPassword, newPassword, confirmPassword)">
                <div class="form-group">
                  <label for="currentPassword">Current Password*</label>
                  <input type="password" class="form-control" id="currentPassword" [(ngModel)]="currentPassword" name="currentPassword" required>
                </div>
                <div class="form-group">
                  <label for="newPassword">New Password*</label>
                  <input type="password" class="form-control" id="newPassword" [(ngModel)]="newPassword" name="newPassword" required>
                </div>
                <div class="form-group">
                  <label for="confirmPassword">Confirm New Password*</label>
                  <input type="password" class="form-control" id="confirmPassword" [(ngModel)]="confirmPassword" name="confirmPassword" required>
                </div>
                <button type="submit" class="btn">Change Password</button>
              </form>
            </div>

            </div>
            </div> 
    </div>
</div>
<app-footer></app-footer>
</body>
</html>
